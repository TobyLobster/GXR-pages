<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 15: Parallelogram and Triangle</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*GXR</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory addresses</a></li>
<li><a href="S-s4.html"><b>$8000</b>: chapter 4</a></li>
<li><a href="S-s5.html"><b>$8167</b>: chapter 5</a></li>
<li><a href="S-s6.html"><b>$82a9</b>: chapter 6</a></li>
<li><a href="S-s7.html"><b>$8349</b>: chapter 7</a></li>
<li><a href="S-s8.html"><b>$88f9</b>: chapter 8</a></li>
<li><a href="S-s9.html"><b>$8955</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$899d</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$8a8a</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$8bb4</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$8d83</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$8dd2</b>: chapter 14</a></li>
<li><span class="unlink"><b>$8e5b</b>: chapter 15</span></li>
<li><a href="S-s16.html"><b>$9044</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$9872</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$9ced</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$9f7c</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$a258</b>: chapter 20</a></li>
<li><a href="S-s21.html"><b>$a40e</b>: chapter 21</a></li>
<li><a href="S-s22.html"><b>$a808</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$b9ea</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$bdd0</b>: chapter 24</a></li>
<li><a href="S-s25.html"><b>$bfdb</b>: chapter 25</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 15: Parallelogram and Triangle' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">GXR</a></li><li><b>Chapter 15: Parallelogram and Triangle</b></li></ul></div>
<p class="purpose">Filled primitives - 489 bytes (2.9%)</p>

<ul class="toc"><li><a href="S-s15.html#SP1">&#167;1. Plot a filled parallelogram and finish PLOT</a></li><li><a href="S-s15.html#SP2">&#167;2. plotParallelogramFilled</a></li><li><a href="S-s15.html#SP3">&#167;3. Plot a filled triangle and finish PLOT</a></li><li><a href="S-s15.html#SP4">&#167;4. Plots a filled parallelogram</a></li><li><a href="S-s15.html#SP5">&#167;5. Plot a filled triangle</a></li><li><a href="S-s15.html#SP6">&#167;6. fillTriangleRowFromLeftToRight</a></li><li><a href="S-s15.html#SP7">&#167;7. Sorts three points, then plots a triangle with a flat top or bottom edge</a></li><li><a href="S-s15.html#SP8">&#167;8. Draw a flat based (or flat topped) triangle</a></li><li><a href="S-s15.html#SP9">&#167;9. makeErrorTermNegative</a></li><li><a href="S-s15.html#SP10">&#167;10. Update the error term then update the left and right extents for the row</a></li><li><a href="S-s15.html#SP11">&#167;11. Update the left and right extents of the current row based on the current point on line X</a></li><li><a href="S-s15.html#SP12">&#167;12. Sort two points, sorting by row first then column</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. Plot a filled parallelogram and finish PLOT. </b></p>

<p class="center-p"><img src="para.png" alt="para.png"></p>

<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. plotParallelogramFilled. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotParallelogramFilled</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">plotParallelogramFilled</span></span>:<br/>Chapter 11: Shared PLOT subroutines and tables - <a href="S-s11.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8e5b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP4" class="function-link"><span class="ACME-function-syntax">plotParallelogramInternal</span></a><span class="ACME-plain-syntax">                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP4" class="function-link"><span class="ACME-function-syntax">setGraphicsCursorPositionAndFinishPLOT</span></a><span class="ACME-plain-syntax">         </span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. Plot a filled triangle and finish PLOT. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Triangles are reimplemented here to add the fill pattern ability. It also fixes some questionable</span>
<span class="ACME-plain-syntax"> rasterisation of the original OS routine. In particular, the following triangle draws a better</span>
<span class="ACME-plain-syntax"> base edge with GXR enabled than without:</span>

<span class="ACME-plain-syntax">     10 MODE 2</span>
<span class="ACME-plain-syntax">     20 MOVE 119*8,72*4</span>
<span class="ACME-plain-syntax">     30 MOVE 40*8,71*4</span>
<span class="ACME-plain-syntax">     40 PLOT 85,80*8,111*4</span>

<span class="ACME-plain-syntax"> Note that the left vertex is one pixel lower than the right vertex. This example is from the roof</span>
<span class="ACME-plain-syntax"> of the Witch's House from the game Citadel (See </span><a href="http://www.bbcmicro.co.uk/game.php?id=290" class="external">http://www.bbcmicro.co.uk/game.php?id=290</a><span class="ACME-plain-syntax"> ).</span>

<span class="ACME-plain-syntax"> Firstly the regular MOS triangle routine:</span>
</pre>
<p class="center-p"><img src="witch_mos.png" alt="witch_mos.png"></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">

<span class="ACME-plain-syntax"> Secondly the GXR triangle routine:</span>
</pre>
<p class="center-p"><img src="witch_gxr.png" alt="witch_gxr.png"></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotTriangleFilled</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">plotTriangleFilled</span></span>:<br/>Chapter 11: Shared PLOT subroutines and tables - <a href="S-s11.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8e61</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP5" class="function-link"><span class="ACME-function-syntax">plotTriangleInternal</span></a><span class="ACME-plain-syntax">                           </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP4" class="function-link"><span class="ACME-function-syntax">setGraphicsCursorPositionAndFinishPLOT</span></a><span class="ACME-plain-syntax">         </span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. Plots a filled parallelogram. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">   Specified by three vertices of the parallelogram:</span>
<span class="ACME-plain-syntax">       - old graphics cursor position</span>
<span class="ACME-plain-syntax">       - current graphics cursor position</span>
<span class="ACME-plain-syntax">       - plot parameter point</span>
<span class="ACME-plain-syntax">   The fourth vertex is calculated from these three.</span>
<span class="ACME-plain-syntax">   The four vertices are sorted from the bottom up.</span>

<span class="ACME-plain-syntax">   Drawn from the bottom up in three parts:</span>

<span class="ACME-plain-syntax">       1. Bottom triangle      (with flat top edge)</span>
<span class="ACME-plain-syntax">       2. Centre parallelogram (with flat top and bottom edges)</span>
<span class="ACME-plain-syntax">       3. Top triangle         (with flat bottom edge)</span>

<span class="ACME-plain-syntax"> e.g.</span>
<span class="ACME-plain-syntax">                                                                    #####  &lt;--- workspaceABCD</span>
<span class="ACME-plain-syntax">                                                                ####    #</span>
<span class="ACME-plain-syntax">                                                            ####        #</span>
<span class="ACME-plain-syntax">                                                        ####           #</span>
<span class="ACME-plain-syntax">                                                    ####               #</span>
<span class="ACME-plain-syntax">                                                ####                  #</span>
<span class="ACME-plain-syntax">                                            ####                      #</span>
<span class="ACME-plain-syntax">                                        ####                         #</span>
<span class="ACME-plain-syntax">                                    ####                3.           #</span>
<span class="ACME-plain-syntax">                                ####                                #</span>
<span class="ACME-plain-syntax">                            ####                                    #</span>
<span class="ACME-plain-syntax">     old graphics ---&gt;  ####---------------------------------------#</span>
<span class="ACME-plain-syntax">           cursor      #                                           #</span>
<span class="ACME-plain-syntax">                       #                                          #</span>
<span class="ACME-plain-syntax">                      #                     2.                    #</span>
<span class="ACME-plain-syntax">                      #                                          #</span>
<span class="ACME-plain-syntax">                     #---------------------------------------####  &lt;--- PLOT parameter</span>
<span class="ACME-plain-syntax">                     #                                   ####</span>
<span class="ACME-plain-syntax">                    #                                ####</span>
<span class="ACME-plain-syntax">                    #                            ####</span>
<span class="ACME-plain-syntax">                   #            1.           ####</span>
<span class="ACME-plain-syntax">                   #                     ####</span>
<span class="ACME-plain-syntax">                  #                  ####</span>
<span class="ACME-plain-syntax">                  #              ####</span>
<span class="ACME-plain-syntax">                 #           ####</span>
<span class="ACME-plain-syntax">                 #       ####</span>
<span class="ACME-plain-syntax">                #    ####</span>
<span class="ACME-plain-syntax"> graphics ---&gt;  #####</span>
<span class="ACME-plain-syntax">   cursor</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotParallelogramInternal</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">plotParallelogramInternal</span></span>:<br/><a href="S-s15.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8e67</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">This calculates the fourth vertex of the parallelogram from the other three:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">workspaceABCD = PLOT parameter - graphics cursor + old graphics cursor</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Loops twice, first with Y=0 (X coordinate) and then with Y=2 (Y coordinate)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">} workspaceAB = PLOT param -</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">} workspaceAB += old graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The next code sorts the four points of the parallelogram vertically:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">XY = SORT(old, current)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.gxrTemp1 = X                  .gxrTemp1 is the index to the smaller Y coordinate of</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                old and current, Yreg is the larger</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">XY = SORT(param, Y)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.gxrTemp2 = X                  .gxrTemp2 is the index to the smaller Y coordinate of</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                param and Yreg, Yreg is the larger</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">XY = SORT(workspaceA, Y)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.gxrTemp4 = Y                  .gxrTemp4 is the index to the larger Y coordinate of</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                workspaceA and Yreg</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">XY = SORT(gxrTemp2, X)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.gxrTemp3 = Y                  .gxrTemp3 is the index to the larger Y coordinate of</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                               .gxrTemp2 and Xreg</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Y = .gxrTemp1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">then calls .sortThreePointsAndPlotFlatEdgedTriangle which completes the process using two</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">more SORT calls.</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">[NOTE: For fewer comparisons (i.e. using 5 SORT calls total instead of 6),</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">       see</span>
<span class="ACME-plain-syntax">    </span><a href="https://stackoverflow.com/questions/6145364/sort-4-number-with-few-comparisons" class="external">https://stackoverflow.com/questions/6145364/sort-4-number-with-few-comparisons</a><span class="ACME-comment-syntax"> ]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">} sort positions X and Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">} so that X is the offset to</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">} the point with the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">} smallest Y coordinate</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp2</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp4</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp2</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Step 1. Draw bottom triangle (with flat top edge)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP7" class="function-link"><span class="ACME-function-syntax">sortThreePointsAndPlotFlatEdgedTriangle</span></a><span class="ACME-plain-syntax">        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Step 2. Draw centre parallelogram (with flat top and bottom edges)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp4</span></a><span class="ACME-plain-syntax">                                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace1</span></a><span class="ACME-plain-syntax">                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP1" class="function-link"><span class="ACME-function-syntax">lineInitialisation</span></a><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The line initialisation sets up line 2 variables:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2StartPointX: initial and current point X [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2StartPointY: initial and current point Y [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2AbsDeltaX  : abs(deltaX)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2AbsDeltaY  : abs(deltaY)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2ErrorTerm  : Bresenham error term        [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2Signs      : signs of deltaY (top bit) and deltaX (bit 6) [1 byte]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace2</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">middle point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">drawFlatParallelogram</span></a><span class="ACME-plain-syntax">                          </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Step 3. Draw top triangle (with flat bottom edge)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp4</span></a><span class="ACME-plain-syntax">                                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace2</span></a><span class="ACME-plain-syntax">                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">drawFlatBasedTriangleInternal</span></a><span class="ACME-plain-syntax">                  </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Draw final row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP6" class="function-link"><span class="ACME-function-syntax">fillTriangleRowFromLeftToRight</span></a><span class="ACME-plain-syntax">                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. Plot a filled triangle. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Triangles are drawn in two halves. First from the bottom to the middle point with a flat</span>
<span class="ACME-plain-syntax"> edge. Then from the flat middle edge up to the peak at the top.</span>


<span class="ACME-plain-syntax">                                            -- &lt;- top point</span>
<span class="ACME-plain-syntax">                                          ---</span>
<span class="ACME-plain-syntax">                                        --  -</span>
<span class="ACME-plain-syntax">                       minor line -&gt;  --   -</span>
<span class="ACME-plain-syntax">                                    --     -</span>
<span class="ACME-plain-syntax">                                  --second-</span>
<span class="ACME-plain-syntax">                                --   half -</span>
<span class="ACME-plain-syntax">                              --         -</span>
<span class="ACME-plain-syntax">             middle point -&gt; #############</span>
<span class="ACME-plain-syntax">                              #         #</span>
<span class="ACME-plain-syntax">                              #  first  #   &lt;- main line ('line 3')</span>
<span class="ACME-plain-syntax">                               #  half #    goes all the way to the top point</span>
<span class="ACME-plain-syntax">                               #       #</span>
<span class="ACME-plain-syntax">                                #     #</span>
<span class="ACME-plain-syntax">                 minor line -&gt;  #     #</span>
<span class="ACME-plain-syntax">                                 #   #</span>
<span class="ACME-plain-syntax">                                 #   #</span>
<span class="ACME-plain-syntax">                                  # #</span>
<span class="ACME-plain-syntax">                                  # #</span>
<span class="ACME-plain-syntax">                                   #</span>
<span class="ACME-plain-syntax">                                   #  &lt;- bottom point</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotTriangleInternal</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">plotTriangleInternal</span></span>:<br/><a href="S-s15.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8ee1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">} sort positions by Y then X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">draw bottom half from lowest</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP7" class="function-link"><span class="ACME-function-syntax">sortThreePointsAndPlotFlatEdgedTriangle</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">point up to the flat base</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">top point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">drawFlatBasedTriangle</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">draw top half from the flat</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">base to top point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through... (to draw final row)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. fillTriangleRowFromLeftToRight. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillTriangleRowFromLeftToRight</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">fillTriangleRowFromLeftToRight</span></span>:<br/><a href="S-s15.html#SP4">&#167;4</a>, <a href="S-s15.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8ef6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s11.html#SP5" class="function-link"><span class="ACME-function-syntax">setMasksAndFillRow</span></a><span class="ACME-plain-syntax">                             </span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. Sorts three points, then plots a triangle with a flat top or bottom edge. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   Xreg and Yreg are workspace offsets to two coordinates</span>
<span class="ACME-plain-syntax">   .gxrTemp3 is the offset to a third coordinate, which must be &gt;= (Yreg offset coordinate)</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   Y: index to middle point</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sortThreePointsAndPlotFlatEdgedTriangle</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">sortThreePointsAndPlotFlatEdgedTriangle</span></span>:<br/><a href="S-s15.html#SP4">&#167;4</a>, <a href="S-s15.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8efd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Sort three points</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">.gxrTemp1 = lower point, Yreg =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">higher point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">compare Yreg with third coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">gxrSortPointsXY</span></a><span class="ACME-plain-syntax">                                </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp2</span></a><span class="ACME-plain-syntax">                                       </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The three values are sorted now:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  .gxrTemp3 is the highest  point of original Xreg,Yreg and .gxrTemp3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  .gxrTemp2 is the middle   point of original Xreg,Yreg and .gxrTemp3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  .gxrTemp1 is the lowest   point of original Xreg,Yreg and .gxrTemp3</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Copy the lowest point to .triangleRowLeftPointX/Y and .triangleRowRightPointX/Y.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">These will track the left and right edge points for the current row.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">loop counter ($FC,$FD,$FE,$FF)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">} store point in</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} .triangleRowLeftPointX/Y and</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} .triangleRowRightPointX/Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Initialise main line ('line 3') variables (see diagram below)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">bottom point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp3</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">top point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace2</span></a><span class="ACME-plain-syntax">                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP1" class="function-link"><span class="ACME-function-syntax">lineInitialisation</span></a><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The line initialisation sets up line 3 variables:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3StartPointX: initial and current point X [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3StartPointY: initial and current point Y [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3AbsDeltaX  : abs(deltaX)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3AbsDeltaY  : abs(deltaY)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3ErrorTerm  : Bresenham error term        [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line3Signs      : signs of deltaY (top bit) and deltaX (bit 6) [1 byte]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp1</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">bottom point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp2</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">middle point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">drawFlatBasedTriangle</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">draw bottom half of triangle</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrTemp2</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">middle point, ready to draw top half</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. Draw a flat based (or flat topped) triangle. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Coordinates have been pre-sorted into top, middle and bottom points of the original triangle.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   A: index of vduVariable for middle point</span>
<span class="ACME-plain-syntax">   Y: index of vduVariable for bottom (start) point</span>
<span class="ACME-plain-syntax">   .line3*: line variables hold the details for the main line</span>

<span class="ACME-plain-syntax">                                                               -- &lt;- top point</span>
<span class="ACME-plain-syntax">                                                             ---</span>
<span class="ACME-plain-syntax">                                                           --  -</span>
<span class="ACME-plain-syntax">                                          minor line -&gt;  --   -</span>
<span class="ACME-plain-syntax">                                                       --     -</span>
<span class="ACME-plain-syntax">                                                     --      -</span>
<span class="ACME-plain-syntax">                                                   --        -</span>
<span class="ACME-plain-syntax">                                                 --         -</span>
<span class="ACME-plain-syntax"> 'A' register, the index of the middle point -&gt; #############</span>
<span class="ACME-plain-syntax">                                                 #         #</span>
<span class="ACME-plain-syntax">                                                 #         #   &lt;- main line (aka 'line 3')</span>
<span class="ACME-plain-syntax">                                                  #       #       goes all the way to the top point</span>
<span class="ACME-plain-syntax">                                                  #       #</span>
<span class="ACME-plain-syntax">                                                   #     #</span>
<span class="ACME-plain-syntax">                                    minor line -&gt;  #     #</span>
<span class="ACME-plain-syntax">                                                    #   #</span>
<span class="ACME-plain-syntax">                                                    #   #</span>
<span class="ACME-plain-syntax">                                                     # #</span>
<span class="ACME-plain-syntax">                                                     # #</span>
<span class="ACME-plain-syntax">                                                      #</span>
<span class="ACME-plain-syntax">                                                      #  &lt;- 'Y' register, the index of the current</span>
<span class="ACME-plain-syntax">                                                             point, starting at the bottom</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">drawFlatBasedTriangle</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">drawFlatBasedTriangle</span></span>:<br/><a href="S-s15.html#SP5">&#167;5</a>, <a href="S-s15.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8f3c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace1</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">store end of minor line index</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">where the minor line initialisation</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">results will go</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">drawFlatBasedTriangleInternal</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">drawFlatBasedTriangleInternal</span></span>:<br/><a href="S-s15.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8f41</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP1" class="function-link"><span class="ACME-function-syntax">lineInitialisation</span></a><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The line initialisation sets up line variables for the minor line, (either line 2 or 3,</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">as specified by the X register).</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">For regular filled triangle plotting, this is line2,</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">For top half of a parallelogram this is line3.</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Assuming line 2, these variables are set up:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2StartPointX: initial and current point X [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2StartPointY: initial and current point Y [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2AbsDeltaX  : abs(deltaX)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2AbsDeltaY  : abs(deltaY)                 [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2ErrorTerm  : Bresenham error term        [2 bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   .line2Signs      : signs of deltaY (top bit) and deltaX (bit 6) [1 byte]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace1</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">get middle point index</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">[NOTE: cheeky little entry point for drawing a parallelogram with flat top and bottom</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">       edges using the same algorithm as drawing the triangle with a single flat edge.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">       This code can actually draw a trapezium with flat top and bottom edges, but in</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">       practice is only used for a triangle or a parallelogram.]</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">drawFlatParallelogram</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">drawFlatParallelogram</span></span>:<br/><a href="S-s15.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8f47</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">remember current point index</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">drawFlatTriangleLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8f49</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Check to see if we are done</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line1AbsDeltaY</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} if (minor line current Y == middle</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} point Y) then branch (finished</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} drawing)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line1AbsDeltaY</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">finishedDrawingTriangle</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">given the current point for the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">minor line, update it until about to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">move to a new row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP10" class="function-link"><span class="ACME-function-syntax">updatePointOnLineXUntilReadyToMoveToNextRow</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">and update the current left or right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point for the row</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">given the current point for the main</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">line, update it until about to move</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to a new row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP10" class="function-link"><span class="ACME-function-syntax">updatePointOnLineXUntilReadyToMoveToNextRow</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">and update the current left or right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point for the row</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP6" class="function-link"><span class="ACME-function-syntax">fillTriangleRowFromLeftToRight</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">fill current row from left point to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">right</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Move to the first point on the next row for each line (having got ready for that before</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">the fill above)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP4" class="function-link"><span class="ACME-function-syntax">lineMoveToNextPixel</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">move to next point on line 2 (which</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">moves to a new row)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP4" class="function-link"><span class="ACME-function-syntax">lineMoveToNextPixel</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">move to next point on line 3 (which</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">moves to a new row)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">sortCoordinatesXYByColumn</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">sort to make X the left point, Y the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">right point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store the new row's left and right points in triangleRow[Left/Right]Point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Remember X (the left point) for later</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">[NOTE: redundant]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remember X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">[NOTE: redundant]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">First store the right point (indexed by Y)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">loop counter ($FC,$FD,$FE,$FF)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">} copy right point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} store in .triangleRowRightPointX/Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Recall X (the left point)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">[NOTE: redundant]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">[NOTE: redundant]</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Lastly store the left point (indexed by X)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">} copy left point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} store in .triangleRowLeftPointX/Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">recall current point index</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">drawFlatTriangleLoop</span></a><span class="ACME-plain-syntax">                           </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishedDrawingTriangle</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8fa4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">We continue to update the line 2 point to get the row span for the final row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line2StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace1</span></a><span class="ACME-plain-syntax">                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">updateToGetRowSpan</span></a><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">We continue to update the line 3 point to get the row span for the final row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">line3StartPointX</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace2</span></a><span class="ACME-plain-syntax">                               </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">updateToGetRowSpan</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8fb3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y coordinates don't match) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP11" class="function-link"><span class="ACME-function-syntax">updateLeftAndRightTriangleRowPoints</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">if (Y coordinates match) then branch</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP10" class="function-link"><span class="ACME-function-syntax">updatePointOnLineXUntilReadyToMoveToNextRow</span></a><span class="ACME-plain-syntax">    </span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. makeErrorTermNegative. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">makeErrorTermNegative</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">makeErrorTermNegative</span></span>:<br/><a href="S-s15.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8fca</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Push X (preserving A)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} push X leaving A untouched</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} [NOTE: wasteful. No need to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} preserve A!]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP4" class="function-link"><span class="ACME-function-syntax">lineMoveToNextPixel</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">move to next point on line X</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Pop X (preserving A)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} pop X leaving A untouched</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} [NOTE: wasteful. No need to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} preserve A!]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. Update the error term then update the left and right extents for the row. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   Preserves X</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">updatePointOnLineXUntilReadyToMoveToNextRow</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">updatePointOnLineXUntilReadyToMoveToNextRow</span></span>:<br/><a href="S-s15.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8fdd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">9</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">check error term</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">makeErrorTermNegative</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (error term &gt;= 0) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">which updates the error term until</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">it becomes negative</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. Update the left and right extents of the current row based on the current point on line X. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> if (lineCurrentX &lt; triangleRowLeftPoint) {</span>
<span class="ACME-plain-syntax">     triangleRowLeftPointX = lineCurrentX</span>
<span class="ACME-plain-syntax">     return</span>
<span class="ACME-plain-syntax"> }</span>
<span class="ACME-plain-syntax"> if (lineCurrentX &gt; triangleRowRightPointX) {</span>
<span class="ACME-plain-syntax">     triangleRowRightPointX = lineCurrentX</span>
<span class="ACME-plain-syntax"> }</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">updateLeftAndRightTriangleRowPoints</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">updateLeftAndRightTriangleRowPoints</span></span>:<br/><a href="S-s15.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8fe2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP11" class="function-link"><span class="ACME-function-syntax">testRightPoint</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (lineCurrentX &gt;=</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">triangleRowLeftPointX) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowLeftPointX</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1                        </span><span class="ACME-comment-syntax">triangleRowLeftPointX = lineCurrentX</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">testRightPoint</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $8ffd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP11" class="function-link"><span class="ACME-function-syntax">return18</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (triangleRowRightPointX &gt;=</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">lineCurrentX) then branch (return)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">triangleRowRightPointX</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1                       </span><span class="ACME-comment-syntax">triangleRowRightPointX = lineCurrentX</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">return18</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $9017</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. Sort two points, sorting by row first then column. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Given two points (one indexed by register X the other by register Y), sort them by row (lowest</span>
<span class="ACME-plain-syntax"> first) then by column (leftmost first)</span>

<span class="ACME-plain-syntax"> i.e. if (point X is higher OR (level and right of point Y)) then swap points in place</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   X is the offset to the lower point</span>
<span class="ACME-plain-syntax">   Y is the offset to the higher point</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">gxrSortPointsXY</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">gxrSortPointsXY</span></span>:<br/><a href="S-s15.html#SP4">&#167;4</a>, <a href="S-s15.html#SP5">&#167;5</a>, <a href="S-s15.html#SP7">&#167;7</a><br/>Chapter 14: Point and Rectangle - <a href="S-s14.html#SP4">&#167;4</a><br/>Chapter 16: Circle - <a href="S-s16.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $9018</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">tempStoreDE is diffLow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">swapXandY</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (vdu[Y,Y+1] &lt; vdu[X,X+1]) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (swap)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">return5</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">if (coordinates are not equal) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Sort so that X = leftmost point, Y = rightmost</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sortCoordinatesXYByColumn</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">sortCoordinatesXYByColumn</span></span>:<br/><a href="S-s15.html#SP8">&#167;8</a><br/>Chapter 14: Point and Rectangle - <a href="S-s14.html#SP4">&#167;4</a><br/>Chapter 19: Rectangle copy and move - <a href="S-s19.html#SP5">&#167;5</a><br/>Chapter 23: Ellipse - <a href="S-s23.html#SP2">&#167;2</a>, <a href="S-s23.html#SP5">&#167;5</a>, <a href="S-s23.html#SP6">&#167;6</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $902d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">return5</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">if (vdu[Y,Y+1] &gt;= vdu[X,X+1]) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">swapXandY</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $903b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">gxrScratchspace3</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">} swap X and Y registers</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">return5</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $9043</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s14.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresssection"><a href="S-s5.html">5</a></li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresssection"><a href="S-s7.html">7</a></li><li class="progresssection"><a href="S-s8.html">8</a></li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresscurrent">15</li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresssection"><a href="S-s21.html">21</a></li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progressnext"><a href="S-s16.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

