<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 21: Sprite commands</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*GXR</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory addresses</a></li>
<li><a href="S-s4.html"><b>$8000</b>: chapter 4</a></li>
<li><a href="S-s5.html"><b>$8167</b>: chapter 5</a></li>
<li><a href="S-s6.html"><b>$82a9</b>: chapter 6</a></li>
<li><a href="S-s7.html"><b>$8349</b>: chapter 7</a></li>
<li><a href="S-s8.html"><b>$88f9</b>: chapter 8</a></li>
<li><a href="S-s9.html"><b>$8955</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$899d</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$8a8a</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$8bb4</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$8d83</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$8dd2</b>: chapter 14</a></li>
<li><a href="S-s15.html"><b>$8e5b</b>: chapter 15</a></li>
<li><a href="S-s16.html"><b>$9044</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$9872</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$9ced</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$9f7c</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$a258</b>: chapter 20</a></li>
<li><span class="unlink"><b>$a40e</b>: chapter 21</span></li>
<li><a href="S-s22.html"><b>$a808</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$b9ea</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$bdd0</b>: chapter 24</a></li>
<li><a href="S-s25.html"><b>$bfdb</b>: chapter 25</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 21: Sprite commands' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">GXR</a></li><li><b>Chapter 21: Sprite commands</b></li></ul></div>
<p class="purpose">*SGET; *SSAVE; *SLOAD; *SMERGE; *SCHOOSE; *SRENUMBER - 1018 bytes (6.2%)</p>

<ul class="toc"><li><a href="S-s21.html#SP1">&#167;1. *SGET n</a></li><li><a href="S-s21.html#SP2">&#167;2. noSpriteMemoryErrorLocal</a></li><li><a href="S-s21.html#SP3">&#167;3. sgetRectOutOfBounds</a></li><li><a href="S-s21.html#SP4">&#167;4. sgetInternal</a></li><li><a href="S-s21.html#SP5">&#167;5. noRoomToGetSpriteError</a></li><li><a href="S-s21.html#SP6">&#167;6. noSpritesError</a></li><li><a href="S-s21.html#SP7">&#167;7. *SSAVE</a></li><li><a href="S-s21.html#SP8">&#167;8. *SLOAD</a></li><li><a href="S-s21.html#SP9">&#167;9. *SMERGE</a></li><li><a href="S-s21.html#SP10">&#167;10. cantOpenFileError</a></li><li><a href="S-s21.html#SP11">&#167;11. Reads a sprite file</a></li><li><a href="S-s21.html#SP12">&#167;12. notEnoughRoomError</a></li><li><a href="S-s21.html#SP13">&#167;13. Prepare the filing system by setting short messages on a cassette / ROM based filing system</a></li><li><a href="S-s21.html#SP14">&#167;14. *SCHOOSE n</a></li><li><a href="S-s21.html#SP15">&#167;15. spriteDoesntExistError</a></li><li><a href="S-s21.html#SP16">&#167;16. starSChooseInternal</a></li><li><a href="S-s21.html#SP17">&#167;17. *SRENUMBER n,m</a></li><li><a href="S-s21.html#SP18">&#167;18. missingCommaError</a></li><li><a href="S-s21.html#SP19">&#167;19. spriteNumbersAreEqualError</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. *SGET n. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Executes 'VDU 23,27,1,n,0,0,0,0,0,0' to capture a rectangle of the screen to sprite n</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY: address of the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSGet</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">starSGet</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a40e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP80" class="function-link"><span class="ACME-function-syntax">read8BitNumberIntoA</span></a><span class="ACME-plain-syntax">                            </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP65" class="function-link"><span class="ACME-function-syntax">printInlineCounted</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">display following message</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">                                             </span><span class="ACME-comment-syntax">length of message to print</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">23</span><span class="ACME-plain-syntax">,27,1                                       </span><span class="ACME-comment-syntax">get sprite from screen</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSWRCH</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">sprite to get</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP65" class="function-link"><span class="ACME-function-syntax">printInlineCounted</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">display following message</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span><span class="ACME-plain-syntax">                                             </span><span class="ACME-comment-syntax">length of message to print</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">0</span><span class="ACME-plain-syntax">,0,0,0,0,0                                   </span><span class="ACME-comment-syntax">finish VDU stream</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. noSpriteMemoryErrorLocal. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">noSpriteMemoryErrorLocal</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">noSpriteMemoryErrorLocal</span></span>:<br/><a href="S-s21.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a428</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP3" class="function-link"><span class="ACME-function-syntax">noSpriteMemoryError</span></a><span class="ACME-plain-syntax">                            </span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. sgetRectOutOfBounds. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetRectOutOfBounds</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">sgetRectOutOfBounds</span></span>:<br/><a href="S-s21.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a42b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. sgetInternal. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetInternal</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">sgetInternal</span></span>:<br/>Chapter 12: VDU commands - <a href="S-s12.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a42d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpritePages</span></a><span class="ACME-plain-syntax">                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP2" class="function-link"><span class="ACME-function-syntax">noSpriteMemoryErrorLocal</span></a><span class="ACME-plain-syntax">                       </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Sort current graphics cursor and old graphics cursor points</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP4" class="function-link"><span class="ACME-function-syntax">sortCoordinatesAsBottomLeftAndTopRight</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">set .vduWorkspaceAB,CD to bottom</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">left point,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and .vduWorkspaceEF,GH to top right</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetBottomLeftPointWithinBounds</span></a><span class="ACME-plain-syntax">                </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001010</span><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP3" class="function-link"><span class="ACME-function-syntax">sgetRectOutOfBounds</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (bottom left point of rectangle</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is right or above graphics window)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #1                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (bottom left point of rect is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">not left of graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">} copy left edge of graphics</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">} window into current workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} i.e. clip to left edge</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #4                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetBottomLeftPointWithinBounds</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (bottom left point is not</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">below the graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">} copy bottom edge of</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">} graphics</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceC</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">} window into current workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} i.e. clip to bottom edge</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetBottomLeftPointWithinBounds</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a45e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetAllWithinBounds</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (top right point is in bounds)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #5                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP3" class="function-link"><span class="ACME-function-syntax">sgetRectOutOfBounds</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (top right point of rectangle</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is left or below graphics window)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #2                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (top right point of rect is not</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">right of the graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsRightLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">} copy right edge of graphics</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">} window into current workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} i.e. clip to right edge</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #8                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetAllWithinBounds</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (top right point of rect is not</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">above the graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsTopLow</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">} copy top edge of graphics</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceG</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">} window into current workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} i.e. clip to top edge</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetAllWithinBounds</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a483</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">setScreenAddress</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">set screen address based on top right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point of rectangle</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.vduWorkspaceAB = width of rect</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">} AB = EF - AB = width of rect</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceF</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Loop to convert AB into a byte width rather than width in pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP5" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">.vduWorkspaceAB /= 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point .vduWorkspaceB is zero, because our sprite is less than 256 pixels wide.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">We reuse .vduWorkspaceB below.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Calculate the width and height of the sprite we are going to create</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">X=A+1         width of sprite</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">B=G-C</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Y=G-C+1       height of sprite</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">If Y=0 Y=255:B-=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = .vduWorkspaceA + 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceG</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceC</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">} B = G - C</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Calculate width * height to see how much memory we need</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP86" class="function-link"><span class="ACME-function-syntax">multiply8x8</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">DE/F = X*Y</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store result in .vduWorkspaceCD</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">[NOTE: redundant, CLC not used]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceC</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceD</span></a><span class="ACME-plain-syntax">                                  </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP78" class="function-link"><span class="ACME-function-syntax">getFreeSpace</span></a><span class="ACME-plain-syntax">                                   </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Now .vduTempStoreDE/DF holds the free space in bytes</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP76" class="function-link"><span class="ACME-function-syntax">findSpriteA</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">skipExistingSprite</span></a><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Add size of existing sprite to free space</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP4" class="function-link"><span class="ACME-function-syntax">spriteHeaderOffsetSizeInBytesLow</span></a><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.spriteHeaderOffsetSizeInBytesHigh</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Add 6 to free space (for the old sprite header data)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} [NOTE: don't add six only to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} subtract it again, just skip</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} forward, i.e.: JMP +]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">skipExistingSprite</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipExistingSprite</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a4ef</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Subtract 6 from the free space (for the new sprite header data)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #6                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Check we have enough room for the new sprite</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (free space &gt;= size of new sprite)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceC</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceD</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP5" class="function-link"><span class="ACME-function-syntax">noRoomToGetSpriteError</span></a><span class="ACME-plain-syntax">                         </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Delete the existing sprite</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP17" class="function-link"><span class="ACME-function-syntax">deleteSpriteInternal</span></a><span class="ACME-plain-syntax">                           </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">tempStoreDC/D = DA/B = start of sprite data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">DA/B += 6 for the sprite header data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #6                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store sprite number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP4" class="function-link"><span class="ACME-function-syntax">spriteHeaderOffsetSpriteNumber</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store current mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=.spriteHeaderOffsetModeNumber</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP5" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODE</span></a><span class="ACME-plain-syntax">                           </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store width and height (4 bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetStoreWidthAndHeight</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a525</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetStoreWidthAndHeight</span></a><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">height (loop counter)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Loop over each row</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetLoopOverRows</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a533</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">width</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Remember current screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sgetLoopOverBytesInRow</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a53c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">A=byte from screen</span>
<span class="ACME-element-syntax">!if</span><span class="ACME-plain-syntax"> (</span><span class="ACME-reserved-syntax">MACHINE</span><span class="ACME-plain-syntax"> = </span><span class="ACME-reserved-syntax">BBC_B</span><span class="ACME-plain-syntax">) | (</span><span class="ACME-reserved-syntax">MACHINE</span><span class="ACME-plain-syntax"> = </span><span class="ACME-reserved-syntax">ELECTRON</span><span class="ACME-plain-syntax">) {</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">read direct from screen memory</span>
<span class="ACME-plain-syntax">} </span><span class="ACME-reserved-syntax">else</span><span class="ACME-plain-syntax"> </span><span class="ACME-reserved-syntax">if</span><span class="ACME-plain-syntax"> </span><span class="ACME-reserved-syntax">MACHINE</span><span class="ACME-plain-syntax"> = </span><span class="ACME-reserved-syntax">BBC_B_PLUS</span><span class="ACME-plain-syntax"> {</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">stash value at $DA which subroutine</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">call will corrupt</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store on stack</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">checkPixelIsBackgroundColourFast</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">read byte from screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP5" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">undo the unwanted eor from</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">subroutine call</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} restore $DA, preserving A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">} </span><span class="ACME-reserved-syntax">else</span><span class="ACME-plain-syntax"> {</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-identifier-syntax">+</span><span class="ACME-reserved-syntax">unknown_machine</span>
<span class="ACME-plain-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store byte</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Move sprite address on one byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Call OS routine to move graphics cursor left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheLeftAndUpdateMask</span></a><span class="ACME-plain-syntax"> </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">byte width-=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetLoopOverBytesInRow</span></a><span class="ACME-plain-syntax">                         </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Restore the screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Move graphics cursor down one row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #8                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP15" class="function-link"><span class="ACME-function-syntax">plotSpriteMoveDownOneCell</span></a><span class="ACME-plain-syntax">                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">vduWorkspaceB</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">reduce loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP4" class="function-link"><span class="ACME-function-syntax">sgetLoopOverRows</span></a><span class="ACME-plain-syntax">                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP18" class="function-link"><span class="ACME-function-syntax">addSprite</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">add the sprite</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP16" class="function-link"><span class="ACME-function-syntax">starSChooseInternal</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">choose the new sprite</span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. noRoomToGetSpriteError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">noRoomToGetSpriteError</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">noRoomToGetSpriteError</span></span>:<br/><a href="S-s21.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a574</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$82</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"No room to get sprite"</span><span class="ACME-plain-syntax">,0                     </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. noSpritesError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">noSpritesError</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">noSpritesError</span></span>:<br/><a href="S-s21.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a58e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$83</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"No Sprites"</span><span class="ACME-plain-syntax">,0                                </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. *SSAVE. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY is the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSSave</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">starSSave</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a59d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP13" class="function-link"><span class="ACME-function-syntax">prepareFilingSystem</span></a><span class="ACME-plain-syntax">                            </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store address of filename</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetFilenameHigh</span></a><span class="ACME-plain-syntax">                   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = .workspaceOffsetFilenameLow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Check we have at least one sprite</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetNumberOfSprites</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP6" class="function-link"><span class="ACME-function-syntax">noSpritesError</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (no sprites) then branch (error)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP78" class="function-link"><span class="ACME-function-syntax">getFreeSpace</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">.vduTempStoreDE/DF = free space in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bytes</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">vduTempStoreDA/B = start of sprite memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpriteStartPage</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store number of sprites</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetNumberOfSprites</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} get number of sprites</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store number of sprites</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store length of sprite data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">subtract start of sprite memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store $FF in the two high bytes of start address and all of the end address.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">i.e. six bytes from .workspaceOffsetStartAddressMid2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetStartAddressMid2</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">offset from sart of private workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #6                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store start address (lower two bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetStartAddressLow</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">low byte zero</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">high byte of start of workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store end address (2 bytes more than start)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetEndAddressMid1</span></a><span class="ACME-plain-syntax">                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">high byte of start of workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">low byte of start of workspace</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory (two).</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetParamBlock</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceHigh</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">} Save two byte file?</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSFILE</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">}</span>


<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP2" class="function-link"><span class="ACME-function-syntax">getPrivateWorkspaceAddress</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">.privateWorkspaceLow/High = private</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP78" class="function-link"><span class="ACME-function-syntax">getFreeSpace</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">.vduTempStoreDE/DF = free space in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bytes</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">vduTempStoreDA/B = start of sprite memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpriteStartPage</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store $FF in two high bytes of start address and all of end address.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">i.e. six bytes from .workspaceOffsetStartAddressMid2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetStartAddressMid2</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">5             </span><span class="ACME-comment-syntax">[NOTE: duplicate of above, could be</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">a function instead to save bytes]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #6                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store start address (start of sprite memory)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetStartAddressLow</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=$5E</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetStartAddressMid1</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">[NOTE: Redundant: Y is already set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to $5E]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store end address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetEndAddressLow</span></a><span class="ACME-plain-syntax">                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = .workspaceOffsetEndAddressMid1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetParamBlock</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceHigh</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">} Save file proper</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSFILE</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">}</span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. *SLOAD. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY is the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSLoad</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">starSLoad</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a638</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP13" class="function-link"><span class="ACME-function-syntax">prepareFilingSystem</span></a><span class="ACME-plain-syntax">                            </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store filename address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">vduTempStoreDC/D = start of sprite data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpriteStartPage</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP11" class="function-link"><span class="ACME-function-syntax">readSpriteFile</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (failed to load) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetNumberOfSprites</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} store number of sprites</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP7" class="function-link"><span class="ACME-function-syntax">resetCurrentSpriteAddress</span></a><span class="ACME-plain-syntax">                      </span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. *SMERGE. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY is the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSMerge</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">starSMerge</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a656</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP13" class="function-link"><span class="ACME-function-syntax">prepareFilingSystem</span></a><span class="ACME-plain-syntax">                            </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store filename address</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP78" class="function-link"><span class="ACME-function-syntax">getFreeSpace</span></a><span class="ACME-plain-syntax">                                   </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP11" class="function-link"><span class="ACME-function-syntax">readSpriteFile</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP9" class="function-link"><span class="ACME-function-syntax">return15</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (error reading file) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = number of sprites</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">vduTempStoreDC/D += 3 (add 3 to sprite address)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #3                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP9" class="function-link"><span class="ACME-function-syntax">addSpriteLoop</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Add each sprite</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">addSpriteLoop</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">addSpriteLoop</span></span>:<br/>Chapter 4: ROM header and service entry routines - <a href="S-s4.html#SP4">&#167;4</a><br/>Chapter 22: Sprite Editor - <a href="S-s22.html#SP23">&#167;23</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a671</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP18" class="function-link"><span class="ACME-function-syntax">addSprite</span></a><span class="ACME-plain-syntax">                                      </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP9" class="function-link"><span class="ACME-function-syntax">addSpriteLoop</span></a><span class="ACME-plain-syntax">                                  </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">return15</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a67b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. cantOpenFileError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">cantOpenFileError</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">cantOpenFileError</span></span>:<br/><a href="S-s21.html#SP11">&#167;11</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a67c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$85</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number [NOTE: should be $84]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Can't open file"</span><span class="ACME-plain-syntax">,0                           </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. Reads a sprite file. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   .vduTempStoreDA/DB - filename address</span>
<span class="ACME-plain-syntax">   .vduTempStoreDC/DD - load address</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   Carry: clear on success</span>
<span class="ACME-plain-syntax">   A: number of sprites after reading the file</span>
<span class="ACME-plain-syntax">   vduTempStoreDC/D: end of sprites address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readSpriteFile</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">readSpriteFile</span></span>:<br/><a href="S-s21.html#SP8">&#167;8</a>, <a href="S-s21.html#SP9">&#167;9</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a690</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store filename address to parameter block in private workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetFilenameLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} set filename address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} i.e.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} workspace[.workspaceOffsetFilenameLow]  = .vduTempStoreDA = filename address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} workspace[.workspaceOffsetFilenameHigh] = .vduTempStoreDB = filename address high</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store load address to parameter block in private workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} Y=#.workspaceOffsetLoadAddressLow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} set load address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} i.e.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">} workspace[load address low] =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduTempStoreDC (load address low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} workspace[load address mid1] =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduTempStoreDD (load address high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} workspace[load address mid2] = $FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} workspace[load address high] = $FF</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">We zero this next byte, meaning 'load the file at the load address given'</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} Y=#.workspaceOffsetExecAddressLow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} workspace[.workspaceOffsetExecAddressLow] = 0</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Store load address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetEndOfSpritesAddressLow</span></a><span class="ACME-plain-syntax">         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">workspace[end of sprites low] =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">tempStoreDC</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">workspace[end of sprite high] =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">tempStoreDD</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Open file for reading</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} Pointer to filename</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$40</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSFIND</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">open file for reading</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP10" class="function-link"><span class="ACME-function-syntax">cantOpenFileError</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (open file fails) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Read two bytes (the size) onto the stack</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = file handle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSBGET</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">get first byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push first byte of file</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSBGET</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">get second byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push second byte</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Close file</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSFIND</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">close file</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP2" class="function-link"><span class="ACME-function-syntax">getPrivateWorkspaceAddress</span></a><span class="ACME-plain-syntax">                     </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Recall first two bytes from stack (size)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} .vduTempStoreDC/DD = first two</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} bytes from file (size)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Add size to current end of sprites address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetEndOfSpritesAddressLow</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} .vduTempStoreDC/DD +=</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} workspace[$65/$66]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} Y =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .workspaceOffsetEndOfSpritesAddressHigh</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Check for enough room</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpriteEndPage</span></a><span class="ACME-plain-syntax">                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace[.workspaceOffsetSpriteEndPage] - .vduTempStoreDC/DD</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP12" class="function-link"><span class="ACME-function-syntax">notEnoughRoomError</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if</span>
<span class="ACME-plain-syntax">                                                        </span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(workspace[.workspaceOffsetSpriteEndPage] &lt; .vduTempStoreDC/DD) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Load file</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetParamBlock</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceHigh</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">} address of parameter block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">load named file</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSFILE</span></a><span class="ACME-plain-syntax">                                         </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP2" class="function-link"><span class="ACME-function-syntax">getPrivateWorkspaceAddress</span></a><span class="ACME-plain-syntax">                     </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">vduTempStoreDC/D = end of sprites address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetEndOfSpritesAddressLow</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} .vduTempStoreDC/DD =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} workspace[.workspaceOffsetEndOfSpritesAddressLow/High]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Get number of sprites</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">} get number of sprites</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. notEnoughRoomError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">notEnoughRoomError</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">notEnoughRoomError</span></span>:<br/><a href="S-s21.html#SP11">&#167;11</a><br/>Chapter 22: Sprite Editor - <a href="S-s22.html#SP20">&#167;20</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a71a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$85</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Not enough room"</span><span class="ACME-plain-syntax">,0                           </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. Prepare the filing system by setting short messages on a cassette / ROM based filing system. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> and get the workspace address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">prepareFilingSystem</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">prepareFilingSystem</span></span>:<br/><a href="S-s21.html#SP7">&#167;7</a>, <a href="S-s21.html#SP8">&#167;8</a>, <a href="S-s21.html#SP9">&#167;9</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a72e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} store X,Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} OSARGS 0,168,0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$A8</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSARGS</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">} return filing system number in A</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FC</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP13" class="function-link"><span class="ACME-function-syntax">restoreXY</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (not cassette or ROM filing</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">system) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$8B</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">} *FX 139,1,1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">} Equivalent to *OPT 1,1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP11" class="function-link"><span class="ACME-function-syntax">OSBYTE</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">} (give short messages)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restoreXY</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a747</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP2" class="function-link"><span class="ACME-function-syntax">getPrivateWorkspaceAddress</span></a><span class="ACME-plain-syntax">                     </span>
</pre>
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. *SCHOOSE n. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY is the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSChoose</span><button class="popup" onclick="togglePopup('usagePopup15')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup15">Usage of <span class="code-font"><span class="ACME-function-syntax">starSChoose</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a74e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP80" class="function-link"><span class="ACME-function-syntax">read8BitNumberIntoA</span></a><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sChooseA</span><button class="popup" onclick="togglePopup('usagePopup16')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup16">Usage of <span class="code-font"><span class="ACME-function-syntax">sChooseA</span></span>:<br/>Chapter 12: VDU commands - <a href="S-s12.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a751</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP16" class="function-link"><span class="ACME-function-syntax">starSChooseInternal</span></a><span class="ACME-plain-syntax">                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP15" class="function-link"><span class="ACME-function-syntax">spriteDoesntExistError</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. spriteDoesntExistError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">spriteDoesntExistError</span><button class="popup" onclick="togglePopup('usagePopup17')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup17">Usage of <span class="code-font"><span class="ACME-function-syntax">spriteDoesntExistError</span></span>:<br/><a href="S-s21.html#SP14">&#167;14</a>, <a href="S-s21.html#SP17">&#167;17</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a757</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$86</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Sprite doesn't exist"</span><span class="ACME-plain-syntax">,0                      </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. starSChooseInternal. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSChooseInternal</span><button class="popup" onclick="togglePopup('usagePopup18')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup18">Usage of <span class="code-font"><span class="ACME-function-syntax">starSChooseInternal</span></span>:<br/><a href="S-s21.html#SP4">&#167;4</a>, <a href="S-s21.html#SP14">&#167;14</a><br/>Chapter 22: Sprite Editor - <a href="S-s22.html#SP23">&#167;23</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a770</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetSpritePages</span></a><span class="ACME-plain-syntax">                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP16" class="function-link"><span class="ACME-function-syntax">schooseError</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if no sprite space, then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(error)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP76" class="function-link"><span class="ACME-function-syntax">findSpriteA</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP16" class="function-link"><span class="ACME-function-syntax">dontStoreSpriteAddress</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if sprite not found, then skip</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">storing the address</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Record the sprite address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetCurrentSpriteAddressLow</span></a><span class="ACME-plain-syntax">        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">dontStoreSpriteAddress</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a789</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP3" class="function-link"><span class="ACME-function-syntax">workspaceOffsetCurrentSpriteAddressLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} zero the current sprite address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">privateWorkspaceLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">schooseError</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a794</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP3" class="function-link"><span class="ACME-function-syntax">noSpriteMemoryError</span></a><span class="ACME-plain-syntax">                            </span>
</pre>
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. *SRENUMBER n,m. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   XY is the rest of the command line</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">starSRenumber</span><button class="popup" onclick="togglePopup('usagePopup19')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup19">Usage of <span class="code-font"><span class="ACME-function-syntax">starSRenumber</span></span>:<br/>Chapter 5: Parsing star commands - <a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a797</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP80" class="function-link"><span class="ACME-function-syntax">read8BitNumberIntoA</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">read first number n</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP79" class="function-link"><span class="ACME-function-syntax">skipLeadingSpaces</span></a><span class="ACME-plain-syntax">                              </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} remember address of remainder of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} command</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP76" class="function-link"><span class="ACME-function-syntax">findSpriteA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get sprite n address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP17" class="function-link"><span class="ACME-function-syntax">spriteNotFound</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if not found then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Skip comma</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-character-syntax">','</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP18" class="function-link"><span class="ACME-function-syntax">missingCommaError</span></a><span class="ACME-plain-syntax">                              </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Move on to next character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP80" class="function-link"><span class="ACME-function-syntax">read8BitNumberIntoA</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">read second number m</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP19" class="function-link"><span class="ACME-function-syntax">spriteNumbersAreEqualError</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">if (n == m) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP17" class="function-link"><span class="ACME-function-syntax">deleteSpriteInternal</span></a><span class="ACME-plain-syntax">                           </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull n</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s22.html#SP76" class="function-link"><span class="ACME-function-syntax">findSpriteA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get sprite address for sprite n</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP4" class="function-link"><span class="ACME-function-syntax">spriteHeaderOffsetSpriteNumber</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get sprite number m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store sprite number m</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">spriteNotFound</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a7d6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s21.html#SP15" class="function-link"><span class="ACME-function-syntax">spriteDoesntExistError</span></a><span class="ACME-plain-syntax">                         </span>
</pre>
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. missingCommaError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">missingCommaError</span><button class="popup" onclick="togglePopup('usagePopup20')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup20">Usage of <span class="code-font"><span class="ACME-function-syntax">missingCommaError</span></span>:<br/><a href="S-s21.html#SP17">&#167;17</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a7d9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$87</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Missing comma"</span><span class="ACME-plain-syntax">,0                             </span><span class="ACME-comment-syntax">error message</span>
</pre>
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. spriteNumbersAreEqualError. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">spriteNumbersAreEqualError</span><button class="popup" onclick="togglePopup('usagePopup21')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup21">Usage of <span class="code-font"><span class="ACME-function-syntax">spriteNumbersAreEqualError</span></span>:<br/><a href="S-s21.html#SP17">&#167;17</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $a7eb</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP8" class="function-link"><span class="ACME-function-syntax">generateError</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$88</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Sprite numbers are equal"</span><span class="ACME-plain-syntax">,0                  </span><span class="ACME-comment-syntax">error message</span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s20.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresssection"><a href="S-s5.html">5</a></li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresssection"><a href="S-s7.html">7</a></li><li class="progresssection"><a href="S-s8.html">8</a></li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresssection"><a href="S-s15.html">15</a></li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresscurrent">21</li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progressnext"><a href="S-s22.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

